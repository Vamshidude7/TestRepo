 ┌────────────────────────────┐
 │   Start: Clean & sort grids│
 └─────────────┬──────────────┘
               │
               ▼
 ┌────────────────────────────┐
 │ Loop through unvisited grid│
 └─────────────┬──────────────┘
               │
               ▼
 ┌────────────────────────────┐
 │ Find MLeaders in Callout   │
 │ Layer inside this grid     │
 └─────────────┬──────────────┘
               │
               ▼
 ┌────────────────────────────┐
 │ Any STA:00+00 leader found?│
 └───────┬───────────────┬────┘
         │Yes            │No
         ▼               ▼
 ┌──────────────────┐    │ Skip grid
 │ Find nearest bore│
 │ polyline to leader│
 └─────────┬────────┘
           ▼
 ┌────────────────────────────┐
 │ Pick nearest end of bore   │
 │ as Start Point (STA:00+00) │
 └─────────┬──────────────────┘
           ▼
 ┌────────────────────────────┐
 │ TraverseAndValidateAllBores│
 └─────────┬──────────────────┘
           ▼
 ┌────────────────────────────┐
 │ TraverseAndValidateBorePath│
 │   (recursive traversal)    │
 └─────────┬──────────────────┘
           ▼
 ┌────────────────────────────┐
 │ runningLength += bore.Length│
 │ expectedSta = FormatStation │
 └─────────┬──────────────────┘
           ▼
 ┌────────────────────────────┐
 │ Look for MLeader near bore │
 │ endpoint → Compare STA     │
 │ If mismatch → record error │
 └─────────┬──────────────────┘
           ▼
 ┌────────────────────────────┐
 │ Find connected bore lines  │
 │ at currentEnd              │
 └─────────┬──────────────────┘
           ▼
 ┌────────────────────────────┐
 │ Connections > 1 ?          │
 └───────┬───────────────┬────┘
         │Yes            │No
         ▼               ▼
 ┌────────────────────────────┐
 │ Evaluate candidates by STA │
 │ Pick MAIN bore (highest STA│
 │ that’s not 00+00)          │
 │ Mark others as BRANCHES    │
 │ Store in branchPoints      │
 └─────────┬──────────────────┘
           ▼
 ┌────────────────────────────┐
 │ Continue traversal on MAIN │
 └─────────┬──────────────────┘
           ▼
 ┌────────────────────────────┐
 │ More bores connected?      │
 └───────┬───────────────┬────┘
         │Yes            │No
         ▼               ▼
 ┌────────────────────────────┐   ┌────────────────────────────┐
 │ Move to next bore segment  │   │ End traversal on this path │
 │ Loop continues             │   └────────────────────────────┘
 └────────────────────────────┘

